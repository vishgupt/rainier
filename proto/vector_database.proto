syntax = "proto3";

package vectordb;

import "google/protobuf/empty.proto";

// Database service for read-only operations
service DatabaseService {
  // List all databases
  rpc ListDatabases(ListDatabasesRequest) returns (ListDatabasesResponse);
  
  // Get database information
  rpc GetDatabase(GetDatabaseRequest) returns (GetDatabaseResponse);
}

// Collection service for read-only operations
service CollectionService {
  // List all collections in a database
  rpc ListCollections(ListCollectionsRequest) returns (ListCollectionsResponse);
  
  // Get collection information
  rpc GetCollection(GetCollectionRequest) returns (GetCollectionResponse);
}

// Point service for vector operations
service PointService {
  // Get a specific point by ID
  rpc GetPoint(GetPointRequest) returns (GetPointResponse);
  
  // Search for nearest neighbors
  rpc SearchNearest(SearchNearestRequest) returns (SearchNearestResponse);
}

// Request to list all databases
message ListDatabasesRequest {
  // Optional pagination
  int32 page = 1;
  int32 limit = 2;
}

// Response containing list of databases
message ListDatabasesResponse {
  repeated Database databases = 1;
  int32 total = 2;
}

// Request to get specific database
message GetDatabaseRequest {
  string database_name = 1;
}

// Response with database details
message GetDatabaseResponse {
  Database database = 1;
}

// Database information
message Database {
  string name = 1;
  string description = 2;
  int64 created_at = 3;
  int64 updated_at = 4;
  map<string, string> metadata = 5;
}

// Request to list collections in a database
message ListCollectionsRequest {
  string database_name = 1;
  int32 page = 2;
  int32 limit = 3;
}

// Response containing list of collections
message ListCollectionsResponse {
  repeated Collection collections = 1;
  int32 total = 2;
}

// Request to get specific collection
message GetCollectionRequest {
  string database_name = 1;
  string collection_name = 2;
}

// Response with collection details
message GetCollectionResponse {
  Collection collection = 1;
}

// Collection information
message Collection {
  string name = 1;
  string database_name = 2;
  string description = 3;
  int32 vector_dimension = 4;
  int64 created_at = 5;
  int64 updated_at = 6;
  map<string, string> metadata = 7;
}

// Request to get a specific point
message GetPointRequest {
  string database_name = 1;
  string collection_name = 2;
  string point_id = 3;
}

// Response with point details
message GetPointResponse {
  Point point = 1;
}

// Request to search for nearest neighbors
message SearchNearestRequest {
  string database_name = 1;
  string collection_name = 2;
  repeated float query_vector = 3;
  int32 limit = 4;
}

// Response with nearest neighbor results
message SearchNearestResponse {
  repeated PointWithDistance results = 1;
}

// Point with distance for search results
message PointWithDistance {
  Point point = 1;
  float distance = 2;
}

// Point/Vector information
message Point {
  string id = 1;
  string collection_name = 2;
  string database_name = 3;
  repeated float vector = 4;
  map<string, string> metadata = 5;
  int64 created_at = 6;
  int64 updated_at = 7;
}
